/* Generated by Rae C backend (experimental) */
#include <stdint.h>
#include <string.h>
#include "rae_runtime.h"

typedef struct {
  RaeAny* data;
  int64_t length;
  int64_t capacity;
} List;

extern const char* rae_ext_rae_io_read_line(void);
extern int64_t rae_ext_rae_io_read_char(void);
extern int64_t rae_ext_nextTick(void);
extern int64_t rae_ext_nowMs(void);
extern void rae_ext_rae_sleep(int64_t ms);
extern double rae_ext_rae_int_to_float(int64_t i);
RAE_UNUSED static double rae_toFloat_Int_(int64_t this);
RAE_UNUSED static List rae_createList_Int_(int64_t initialCap);
RAE_UNUSED static void rae_grow_List_(List* this);
RAE_UNUSED static void rae_add_List_T_(List* this, RaeAny value);
RAE_UNUSED static RaeAny rae_get_List_Int_(List* this, int64_t index);
RAE_UNUSED static void rae_set_List_Int_T_(List* this, int64_t index, RaeAny value);
RAE_UNUSED static void rae_insert_List_Int_T_(List* this, int64_t index, RaeAny value);
RAE_UNUSED static RaeAny rae_pop_List_(List* this);
RAE_UNUSED static void rae_remove_List_Int_(List* this, int64_t index);
RAE_UNUSED static void rae_clear_List_(List* this);
RAE_UNUSED static int64_t rae_length_List_(List* this);
RAE_UNUSED static void rae_swap_List_Int_Int_(List* this, int64_t i, int64_t j);
RAE_UNUSED static void rae_free_List_(List* this);
RAE_UNUSED static void rae_helper_Int_Int_(int64_t a, int64_t b);
RAE_UNUSED static int64_t rae_sumChain_Int_Int_(int64_t a, int64_t b);

RAE_UNUSED static double rae_toFloat_Int_(int64_t this) {
  return rae_ext_rae_int_to_float(this);
}

RAE_UNUSED static List rae_createList_Int_(int64_t initialCap) {
  return (List){ .data = rae_ext_rae_buf_alloc(initialCap, sizeof(RaeAny)), .length = 0, .capacity = initialCap };
}

RAE_UNUSED static void rae_grow_List_(List* this) {
  int64_t newCap = this->capacity * 2;
  if (newCap == 0) {
  newCap = 4;
  }
  RaeAny* newData = rae_ext_rae_buf_alloc(newCap, sizeof(RaeAny));
  rae_ext_rae_buf_copy(this->data, 0, newData, 0, this->length, sizeof(RaeAny));
  rae_ext_rae_buf_free(this->data);
  this->data = newData;
  this->capacity = newCap;
}

RAE_UNUSED static void rae_add_List_T_(List* this, RaeAny value) {
  if (this->length == this->capacity) {
  rae_grow_List_(this);
  }
  ((RaeAny*)(this->data))[this->length] = rae_any(value);
  this->length = this->length + 1;
}

RAE_UNUSED static RaeAny rae_get_List_Int_(List* this, int64_t index) {
  if (index < 0 || index >= this->length) {
  return rae_any_none();
  }
  return rae_any(((RaeAny*)(this->data))[index]);
}

RAE_UNUSED static void rae_set_List_Int_T_(List* this, int64_t index, RaeAny value) {
  if (index < 0 || index >= this->length) {
  return;
  }
  ((RaeAny*)(this->data))[index] = rae_any(value);
}

RAE_UNUSED static void rae_insert_List_Int_T_(List* this, int64_t index, RaeAny value) {
  if (index < 0 || index > this->length) {
  return;
  }
  if (this->length == this->capacity) {
  rae_grow_List_(this);
  }
  if (index < this->length) {
  rae_ext_rae_buf_copy(this->data, index, this->data, index + 1, this->length - index, sizeof(RaeAny));
  }
  ((RaeAny*)(this->data))[index] = rae_any(value);
  this->length = this->length + 1;
}

RAE_UNUSED static RaeAny rae_pop_List_(List* this) {
  if (this->length == 0) {
  return rae_any_none();
  }
  RaeAny val = ((RaeAny*)(this->data))[this->length - 1];
  this->length = this->length - 1;
  return rae_any(val);
}

RAE_UNUSED static void rae_remove_List_Int_(List* this, int64_t index) {
  if (index < 0 || index >= this->length) {
  return;
  }
  if (index < this->length - 1) {
  rae_ext_rae_buf_copy(this->data, index + 1, this->data, index, this->length - index - 1, sizeof(RaeAny));
  }
  this->length = this->length - 1;
}

RAE_UNUSED static void rae_clear_List_(List* this) {
  this->length = 0;
}

RAE_UNUSED static int64_t rae_length_List_(List* this) {
  return this->length;
}

RAE_UNUSED static void rae_swap_List_Int_Int_(List* this, int64_t i, int64_t j) {
  RaeAny temp = ((RaeAny*)(this->data))[i];
  ((RaeAny*)(this->data))[i] = rae_any(((RaeAny*)(this->data))[j]);
  ((RaeAny*)(this->data))[j] = rae_any(temp);
}

RAE_UNUSED static void rae_free_List_(List* this) {
  rae_ext_rae_buf_free(this->data);
  this->length = 0;
  this->capacity = 0;
}

RAE_UNUSED static void rae_helper_Int_Int_(int64_t a, int64_t b) {
  rae_ext_rae_log_cstr("Helper ran");
}

RAE_UNUSED static int64_t rae_sumChain_Int_Int_(int64_t a, int64_t b) {
  rae_ext_rae_log_cstr("sumChain start");
  int64_t total = a + b;
  if (total > 5) {
  rae_ext_rae_log_cstr("total > 5");
  } else {
  rae_ext_rae_log_cstr("total <= 5");
  }
  rae_ext_rae_log_cstr("sumChain done");
  return total;
}

int main(void) {
  rae_ext_rae_log_cstr("C backend demo start");
  rae_helper_Int_Int_(1, 2);
  int64_t res = rae_sumChain_Int_Int_(3, 4);
  rae_ext_rae_log_cstr("C backend demo end");
  return 0;
}

