# Queue

- [x] Fix VM stack overflow crash in Advanced Pong (vm.c, vm.h)
- [x] Fix "unknown opcode" crash during hot-reload exit (vm_patch.c)
- [x] Fix C backend struct ordering and function signature resolution (c_backend.c)
- [x] Implement implicit project imports (main.c)
- [x] **Phase 1: Buffer Infrastructure**
    - [x] Add `VAL_BUFFER` to `vm_value.h` and implement its lifecycle (alloc/free).
    - [x] Add `OP_BUF_ALLOC`, `OP_BUF_FREE`, `OP_BUF_GET`, `OP_BUF_SET`, `OP_BUF_COPY` opcodes to VM.
    - [x] Expose these as `priv` built-in functions in the compiler.
    - [x] Implement C-backend mapping for raw buffers.
- [x] **Phase 2: List2 (Non-Generic Prototype)**
    - [x] Implement `List2Int` in Rae using `Buffer`.
    - [x] Implement `add`, `get`, `length`, and `remove` (with shifting) in Rae.
    - [x] Create benchmark comparing `List` (C) vs `List2Int` (Rae).
- [x] **Phase 3: Heterogeneous Lists (Any Type)**
    - [x] Implement `Any` type support in compiler and VM.
    - [x] Implement `List2` (using `Any`) in Rae.
    - [x] Add automatic boxing/unboxing in C backend.
- [x] **Phase 4: Generic List2<T>**
    - [x] Implement `List2<T>` in Rae.
    - [x] Add compiler support for generic type erasure in C backend.
    - [x] Verify `List2<Int>` and `List2<String>` work in both VM and Compiled modes.
- [x] **Phase 5: Production List Transition**
    - [x] Rename `List2` to `List`.
    - [x] Move `Buffer` and `List` implementation to `core.rae`.
    - [x] Remove C-backed `List` implementation from compiler and runtime.
    - [x] Verify all existing tests and examples still pass.
- [ ] **Phase 6: Standard Library Implementation**
    - [ ] **Compiler Infrastructure**
        - [x] Implement Type-Based Dispatch (Overloading) in VM compiler.
        - [x] Implement Type-Based Dispatch (Overloading) in C backend.
        - [x] Implement Name Mangling (`Type_method`) in C backend.
        - [ ] Implement Conditional Auto-Imports (import only if symbol used).
    - [ ] **Module: core**
        - [ ] Standardize `nowMs()`, `sleep(ms)`, `nextTick()`.
        - [ ] Move `List(T)` methods to standard naming (`add`, `get`, `length`, etc.).
    - [ ] **Module: math**
        - [ ] Implement basic math overloads (`abs`, `min`, `max`, `clamp`).
        - [ ] Standardize randomness (`seed`, `randomFloat`, `randomInt`).
    - [ ] **Module: string**
        - [ ] Implement `length`, `compare`, `concat`, `sub`, `contains`, `toFloat`, `toInt`.
    - [ ] **Module: io**
        - [ ] Standardize `log`, `logS`.
        - [ ] Implement `readLine`, `readChar`.
    - [ ] **Module: sys**
        - [x] Implement `exit`, `getEnv`, `args`, `readFile`, `writeFile`.
- [ ] **Phase 7: Tetris-Ready Features**
    - [ ] **Struct-to-Struct FFI**
        - [ ] Add `@c_struct` attribute or similar hint to Rae types.
        - [ ] Update C backend to emit C struct literals and pass them by value to externs.
        - [ ] Clean up `raylib.rae` to use `Color` and `Vector2` structs directly.
    - [ ] **Enums**
        - [ ] Add `enum` keyword to parser.
        - [ ] Implement enum members as constant `Int` values in VM and C backend.
        - [ ] Support enum exhaustive matching in `match` statements.
    - [ ] **Tetris Prototype**
        - [ ] Implement a clean, high-quality Tetris using new features.

